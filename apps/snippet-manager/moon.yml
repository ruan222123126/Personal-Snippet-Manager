# apps/snippet-manager/moon.yml

type: "application"

# ✅ 关键修改 1：设为 unknown，彻底绕过版本检查
language: "unknown"

# ✅ 关键修改 2：保持 system 模式
platform: "system"

tasks:
  dev:
    # 加上 npx 前缀最保险
    command: "npx next dev -p 3002"
    local: true

  build:
    command: "npx next build"
    inputs:
      - "app/**/*"
      - "components/**/*"
      - "prisma/**/*"
      - "public/**/*"
      - "next.config.mjs"
      - "postcss.config.cjs"
      - "tailwind.config.ts"
      - "tsconfig.json"
      # ✅ 关键修改 3：必须手动加上这个，否则装新包不会触发重构建
      - "package.json"
    outputs:
      - ".next"

  "db-push":
    command: "npx prisma db push"

  "db-studio":
    command: "npx prisma studio"
    local: true

  "script-seed":
    command: "node scripts/create-sample-data.js"

  "script-list":
    command: "node scripts/list-snippets.js"
