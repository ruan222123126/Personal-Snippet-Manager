{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/lib/shiki.ts"],"sourcesContent":["// Shiki Highlighter singleton\n// Global reference to prevent multiple initializations in development\n\nimport { createHighlighter } from 'shiki';\n\nconst globalForShiki = globalThis as unknown as {\n  highlighter: Awaited<ReturnType<typeof createHighlighter>> | undefined;\n};\n\nexport async function getShikiHighlighter() {\n  if (!globalForShiki.highlighter) {\n    globalForShiki.highlighter = await createHighlighter({\n      themes: ['github-dark', 'github-light'],\n      langs: [\n        'javascript',\n        'typescript',\n        'python',\n        'java',\n        'cpp',\n        'c',\n        'go',\n        'rust',\n        'html',\n        'css',\n        'json',\n        'bash',\n        'sql',\n        'markdown',\n        'text',\n      ],\n    });\n  }\n  return globalForShiki.highlighter;\n}\n\n/**\n * Highlights code using Shiki with theme support for light/dark modes\n * @param code - The source code to highlight\n * @param language - The programming language (falls back to 'text' if unsupported)\n * @returns HTML string with syntax highlighting\n */\nexport async function highlightCode(code: string, language: string): Promise<string> {\n  const highlighter = await getShikiHighlighter();\n  // Fallback to 'text' if the language is not supported\n  const loadedLangs = highlighter.getLoadedLanguages();\n  const lang = loadedLangs.includes(language) ? language : 'text';\n\n  return highlighter.codeToHtml(code, {\n    lang,\n    themes: {\n      light: 'github-light',\n      dark: 'github-dark',\n    },\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA,8BAA8B;AAC9B,sEAAsE;AAEtE;;AAEA,MAAM,iBAAiB;AAIhB,eAAe;IACpB,IAAI,CAAC,eAAe,WAAW,EAAE;QAC/B,eAAe,WAAW,GAAG,MAAM,IAAA,wLAAiB,EAAC;YACnD,QAAQ;gBAAC;gBAAe;aAAe;YACvC,OAAO;gBACL;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;aACD;QACH;IACF;IACA,OAAO,eAAe,WAAW;AACnC;AAQO,eAAe,cAAc,IAAY,EAAE,QAAgB;IAChE,MAAM,cAAc,MAAM;IAC1B,sDAAsD;IACtD,MAAM,cAAc,YAAY,kBAAkB;IAClD,MAAM,OAAO,YAAY,QAAQ,CAAC,YAAY,WAAW;IAEzD,OAAO,YAAY,UAAU,CAAC,MAAM;QAClC;QACA,QAAQ;YACN,OAAO;YACP,MAAM;QACR;IACF;AACF"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/ui/CopyButton.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { DocumentDuplicateIcon, CheckIcon } from '@heroicons/react/24/outline';\n\ninterface CopyButtonProps {\n  code: string;\n}\n\nexport function CopyButton({ code }: CopyButtonProps) {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = async () => {\n    try {\n      // 优先使用现代剪贴板API\n      if (navigator.clipboard && window.isSecureContext) {\n        await navigator.clipboard.writeText(code);\n      } else {\n        // 降级方案：使用传统的document.execCommand\n        const textArea = document.createElement('textarea');\n        textArea.value = code;\n        textArea.style.position = 'fixed';\n        textArea.style.left = '-999999px';\n        textArea.style.top = '-999999px';\n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        const successful = document.execCommand('copy');\n        document.body.removeChild(textArea);\n\n        if (!successful) {\n          throw new Error('复制失败');\n        }\n      }\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (error) {\n      console.error('复制失败:', error);\n      // 可选：显示错误提示给用户\n    }\n  };\n\n  return (\n    <button\n      onClick={handleCopy}\n      className=\"p-2 rounded-md bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n      title={copied ? '已复制' : '复制代码'}\n    >\n      {copied ? (\n        <CheckIcon className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\n      ) : (\n        <DocumentDuplicateIcon className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n      )}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAHA;;;AASO,SAAS,WAAW,EAAE,IAAI,EAAmB;;IAClD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,MAAM,aAAa;QACjB,IAAI;YACF,eAAe;YACf,IAAI,UAAU,SAAS,IAAI,OAAO,eAAe,EAAE;gBACjD,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;YACtC,OAAO;gBACL,iCAAiC;gBACjC,MAAM,WAAW,SAAS,aAAa,CAAC;gBACxC,SAAS,KAAK,GAAG;gBACjB,SAAS,KAAK,CAAC,QAAQ,GAAG;gBAC1B,SAAS,KAAK,CAAC,IAAI,GAAG;gBACtB,SAAS,KAAK,CAAC,GAAG,GAAG;gBACrB,SAAS,IAAI,CAAC,WAAW,CAAC;gBAC1B,SAAS,KAAK;gBACd,SAAS,MAAM;gBACf,MAAM,aAAa,SAAS,WAAW,CAAC;gBACxC,SAAS,IAAI,CAAC,WAAW,CAAC;gBAE1B,IAAI,CAAC,YAAY;oBACf,MAAM,IAAI,MAAM;gBAClB;YACF;YACA,UAAU;YACV,WAAW,IAAM,UAAU,QAAQ;QACrC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,SAAS;QACvB,eAAe;QACjB;IACF;IAEA,qBACE,6LAAC;QACC,SAAS;QACT,WAAU;QACV,OAAO,SAAS,QAAQ;kBAEvB,uBACC,6LAAC,iOAAS;YAAC,WAAU;;;;;iCAErB,6LAAC,qQAAqB;YAAC,WAAU;;;;;;;;;;;AAIzC;GA9CgB;KAAA"}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/ui/CodeBlock.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { highlightCode } from '@/lib/shiki';\nimport { CopyButton } from './CopyButton';\n\ninterface CodeBlockProps {\n  code: string;\n  language: string;\n  /** 最大显示行数，超出部分截断 */\n  maxLines?: number;\n}\n\nexport function CodeBlock({ code, language, maxLines }: CodeBlockProps) {\n  const [html, setHtml] = useState<string>('');\n\n  useEffect(() => {\n    let cancelled = false;\n\n    highlightCode(code, language).then((highlightedHtml) => {\n      if (!cancelled) {\n        setHtml(highlightedHtml);\n      }\n    });\n\n    return () => {\n      cancelled = true;\n    };\n  }, [code, language]);\n\n  // 计算固定高度（基于行数）\n  const height = maxLines ? `${maxLines * 1.5}rem` : undefined;\n\n  // 加载中状态显示纯代码\n  if (!html) {\n    return (\n      <div className=\"relative group rounded-lg overflow-hidden border border-gray-200 bg-gray-50/50 dark:border-gray-800 dark:bg-[#0d1117]\" style={height ? { height } : undefined}>\n        <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10\">\n          <CopyButton code={code} />\n        </div>\n        <pre className=\"text-sm font-mono overflow-hidden p-4 h-full\">\n          <code>{code}</code>\n        </pre>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative group rounded-lg overflow-hidden border border-gray-200 bg-gray-50/50 dark:border-gray-800 dark:bg-[#0d1117]\" style={height ? { height } : undefined}>\n      <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10\">\n        <CopyButton code={code} />\n      </div>\n      <div\n        className=\"text-sm font-mono overflow-hidden p-4 h-full [&>pre]:!bg-transparent [&>pre]:!p-0 [&>pre]:!m-0\"\n        dangerouslySetInnerHTML={{ __html: html }}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAaO,SAAS,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAkB;;IACpE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAS;IAEzC,IAAA,0KAAS;+BAAC;YACR,IAAI,YAAY;YAEhB,IAAA,8JAAa,EAAC,MAAM,UAAU,IAAI;uCAAC,CAAC;oBAClC,IAAI,CAAC,WAAW;wBACd,QAAQ;oBACV;gBACF;;YAEA;uCAAO;oBACL,YAAY;gBACd;;QACF;8BAAG;QAAC;QAAM;KAAS;IAEnB,eAAe;IACf,MAAM,SAAS,WAAW,GAAG,WAAW,IAAI,GAAG,CAAC,GAAG;IAEnD,aAAa;IACb,IAAI,CAAC,MAAM;QACT,qBACE,6LAAC;YAAI,WAAU;YAAwH,OAAO,SAAS;gBAAE;YAAO,IAAI;;8BAClK,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,8KAAU;wBAAC,MAAM;;;;;;;;;;;8BAEpB,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;kCAAM;;;;;;;;;;;;;;;;;IAIf;IAEA,qBACE,6LAAC;QAAI,WAAU;QAAwH,OAAO,SAAS;YAAE;QAAO,IAAI;;0BAClK,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,8KAAU;oBAAC,MAAM;;;;;;;;;;;0BAEpB,6LAAC;gBACC,WAAU;gBACV,yBAAyB;oBAAE,QAAQ;gBAAK;;;;;;;;;;;;AAIhD;GA7CgB;KAAA"}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/app/actions.ts"],"sourcesContent":["'use server';\n\nimport { prisma } from '@/lib/prisma';\nimport { revalidatePath } from 'next/cache';\nimport { redirect } from 'next/navigation';\n\n/**\n * 删除代码片段\n *\n * @param id - 代码片段 ID\n * @throws Error 如果代码片段不存在\n */\nexport async function deleteSnippet(id: string) {\n  try {\n    // 先检查代码片段是否存在\n    const snippet = await prisma.snippet.findUnique({\n      where: { id },\n    });\n\n    if (!snippet) {\n      throw new Error('代码片段不存在');\n    }\n\n    // 删除代码片段（关联的标签记录会通过级联删除自动处理）\n    await prisma.snippet.delete({\n      where: { id },\n    });\n\n    // 重新验证首页缓存\n    revalidatePath('/');\n\n    return { success: true };\n  } catch (error) {\n    console.error('删除代码片段失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 删除代码片段并重定向\n *\n * 这个版本用于表单提交，删除成功后自动重定向到首页\n *\n * @param id - 代码片段 ID\n */\nexport async function deleteSnippetAndRedirect(id: string) {\n  await deleteSnippet(id);\n  redirect('/');\n}\n"],"names":[],"mappings":";;;;;;;MAYsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,iDAAA"}},
    {"offset": {"line": 288, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/SnippetActions.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useTransition, useEffect } from 'react';\nimport { PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { deleteSnippet } from '@/app/actions';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { createPortal } from 'react-dom';\n\ninterface SnippetActionsProps {\n  snippetId: string;\n}\n\n/**\n * 代码片段操作按钮组件\n *\n * 提供编辑和删除功能：\n * - 编辑按钮：跳转到编辑页面\n * - 删除按钮：显示确认对话框，确认后删除\n */\nexport function SnippetActions({ snippetId }: SnippetActionsProps) {\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isPending, startTransition] = useTransition();\n  const [mounted, setMounted] = useState(false);\n  const router = useRouter();\n\n  // 确保组件已挂载，才能使用 Portal\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  const handleDelete = async () => {\n    setIsDeleting(true);\n\n    try {\n      startTransition(async () => {\n        await deleteSnippet(snippetId);\n        // 删除成功后刷新页面\n        router.refresh();\n      });\n    } catch (error) {\n      console.error('删除失败:', error);\n      alert('删除失败，请稍后重试');\n      setIsDeleting(false);\n      setShowDeleteConfirm(false);\n    }\n  };\n\n  const handleDeleteClick = () => {\n    setShowDeleteConfirm(true);\n  };\n\n  const handleCancelDelete = () => {\n    setShowDeleteConfirm(false);\n    setIsDeleting(false);\n  };\n\n  // 阻止事件冒泡，避免触发卡片点击跳转\n  const stopPropagation = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    // 不要调用 preventDefault()，否则会阻止链接的默认导航行为\n  };\n\n  return (\n    <>\n      <div className=\"flex items-center gap-1\" onClick={stopPropagation}>\n        {/* 编辑按钮 */}\n        <Link\n          href={`/snippets/${snippetId}/edit`}\n          className=\"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors duration-200 relative z-20\"\n          title=\"编辑\"\n          onClick={(e) => e.stopPropagation()}\n        >\n          <PencilIcon className=\"w-4 h-4\" />\n        </Link>\n\n        {/* 删除按钮 */}\n        <button\n          onClick={(e) => {\n            stopPropagation(e);\n            handleDeleteClick();\n          }}\n          disabled={isDeleting || isPending}\n          className=\"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed relative z-20\"\n          title=\"删除\"\n        >\n          <TrashIcon className=\"w-4 h-4\" />\n        </button>\n      </div>\n\n      {/* 删除确认对话框 */}\n      {showDeleteConfirm && mounted && createPortal(\n        <div\n          className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] p-4\"\n          onClick={handleCancelDelete}\n        >\n          <div\n            className=\"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 animate-in fade-in zoom-in duration-200\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2\">\n              确认删除\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              删除后无法恢复，确定要删除这个代码片段吗？\n            </p>\n\n            <div className=\"flex items-center justify-end gap-3\">\n              <button\n                onClick={handleCancelDelete}\n                disabled={isDeleting || isPending}\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                取消\n              </button>\n              <button\n                onClick={handleDelete}\n                disabled={isDeleting || isPending}\n                className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isDeleting || isPending ? '删除中...' : '删除'}\n              </button>\n            </div>\n          </div>\n        </div>,\n        document.body\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AAoBO,SAAS,eAAe,EAAE,SAAS,EAAuB;;IAC/D,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAC;IAC3D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,WAAW,gBAAgB,GAAG,IAAA,8KAAa;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,kJAAS;IAExB,sBAAsB;IACtB,IAAA,0KAAS;oCAAC;YACR,WAAW;QACb;mCAAG,EAAE;IAEL,MAAM,eAAe;QACnB,cAAc;QAEd,IAAI;YACF,gBAAgB;gBACd,MAAM,IAAA,6LAAa,EAAC;gBACpB,YAAY;gBACZ,OAAO,OAAO;YAChB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,SAAS;YACvB,MAAM;YACN,cAAc;YACd,qBAAqB;QACvB;IACF;IAEA,MAAM,oBAAoB;QACxB,qBAAqB;IACvB;IAEA,MAAM,qBAAqB;QACzB,qBAAqB;QACrB,cAAc;IAChB;IAEA,oBAAoB;IACpB,MAAM,kBAAkB,CAAC;QACvB,EAAE,eAAe;IACjB,uCAAuC;IACzC;IAEA,qBACE;;0BACE,6LAAC;gBAAI,WAAU;gBAA0B,SAAS;;kCAEhD,6LAAC,0KAAI;wBACH,MAAM,CAAC,UAAU,EAAE,UAAU,KAAK,CAAC;wBACnC,WAAU;wBACV,OAAM;wBACN,SAAS,CAAC,IAAM,EAAE,eAAe;kCAEjC,cAAA,6LAAC,oOAAU;4BAAC,WAAU;;;;;;;;;;;kCAIxB,6LAAC;wBACC,SAAS,CAAC;4BACR,gBAAgB;4BAChB;wBACF;wBACA,UAAU,cAAc;wBACxB,WAAU;wBACV,OAAM;kCAEN,cAAA,6LAAC,iOAAS;4BAAC,WAAU;;;;;;;;;;;;;;;;;YAKxB,qBAAqB,yBAAW,IAAA,oLAAY,gBAC3C,6LAAC;gBACC,WAAU;gBACV,SAAS;0BAET,cAAA,6LAAC;oBACC,WAAU;oBACV,SAAS,CAAC,IAAM,EAAE,eAAe;;sCAEjC,6LAAC;4BAAG,WAAU;sCAA8D;;;;;;sCAG5E,6LAAC;4BAAE,WAAU;sCAAwC;;;;;;sCAIrD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,SAAS;oCACT,UAAU,cAAc;oCACxB,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,SAAS;oCACT,UAAU,cAAc;oCACxB,WAAU;8CAET,cAAc,YAAY,WAAW;;;;;;;;;;;;;;;;;;;;;;sBAK9C,SAAS,IAAI;;;AAIrB;GA9GgB;;QAGuB,8KAAa;QAEnC,kJAAS;;;KALV"}},
    {"offset": {"line": 480, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/ui/TutorialView.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\n// @ts-ignore - rehype-raw may not have full type definitions\nimport rehypeRaw from 'rehype-raw';\nimport { highlightCode } from '@/lib/shiki';\nimport { createPortal } from 'react-dom';\n\ninterface TutorialViewProps {\n  /** Markdown 格式的教学内容 */\n  tutorial: string;\n  /** 关闭回调 */\n  onClose: () => void;\n  /** 代码语言 (用于代码块高亮) */\n  language?: string;\n}\n\n/**\n * 教学内容展示组件\n *\n * 以模态框形式展示 Markdown 格式的教学文档\n * 支持代码高亮、GFM 语法和响应式设计\n */\nexport function TutorialView({ tutorial, onClose, language = 'text' }: TutorialViewProps) {\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  if (!mounted) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\"\n      onClick={onClose}\n    >\n      <div\n        className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] overflow-hidden flex flex-col animate-in zoom-in duration-200\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50\">\n          <div className=\"flex items-center gap-2\">\n            <svg\n              className=\"w-6 h-6 text-blue-500\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\"\n              />\n            </svg>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-gray-100\">教学说明</h2>\n          </div>\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\"\n            aria-label=\"关闭\"\n          >\n            <svg className=\"w-5 h-5 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto px-6 py-6\">\n          <article className=\"prose prose-sm dark:prose-invert max-w-none prose-headings:font-bold prose-a:text-blue-500 prose-a:no-underline hover:prose-a:underline prose-pre:bg-gray-900 dark:prose-pre:bg-gray-950 prose-pre:border prose-pre:border-gray-200 dark:prose-pre:border-gray-700\">\n            <ReactMarkdown\n              remarkPlugins={[remarkGfm]}\n              rehypePlugins={[rehypeRaw]}\n              components={{\n                code({ className, children, ...props }: any) {\n                  const match = /language-(\\w+)/.exec(className || '');\n                  const codeLang = match ? match[1] : language;\n                  const codeContent = String(children).replace(/\\n$/, '');\n\n                  if (codeContent.includes('\\n')) {\n                    return (\n                      <div className=\"relative group\">\n                        <pre className={className} {...props}>\n                          <code>{children}</code>\n                        </pre>\n                      </div>\n                    );\n                  }\n                  return (\n                    <code className={className} {...props}>\n                      {children}\n                    </code>\n                  );\n                },\n                h1({ children }) {\n                  return <h1 className=\"text-2xl font-bold mb-4\">{children}</h1>;\n                },\n                h2({ children }) {\n                  return <h2 className=\"text-xl font-bold mb-3 mt-6\">{children}</h2>;\n                },\n                h3({ children }) {\n                  return <h3 className=\"text-lg font-bold mb-2 mt-4\">{children}</h3>;\n                },\n                ul({ children }) {\n                  return <ul className=\"list-disc list-inside space-y-1 my-3\">{children}</ul>;\n                },\n                ol({ children }) {\n                  return <ol className=\"list-decimal list-inside space-y-1 my-3\">{children}</ol>;\n                },\n                li({ children }) {\n                  return <li className=\"text-gray-700 dark:text-gray-300\">{children}</li>;\n                },\n                p({ children }) {\n                  return <p className=\"my-3 leading-7\">{children}</p>;\n                },\n                blockquote({ children }) {\n                  return (\n                    <blockquote className=\"border-l-4 border-blue-500 pl-4 italic my-4 text-gray-600 dark:text-gray-400\">\n                      {children}\n                    </blockquote>\n                  );\n                },\n              }}\n            >\n              {tutorial}\n            </ReactMarkdown>\n          </article>\n        </div>\n\n        {/* Footer */}\n        <div className=\"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 flex justify-end\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors font-medium\"\n          >\n            关闭\n          </button>\n        </div>\n      </div>\n    </div>,\n    document.body\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 778, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/lib/highlight.ts"],"sourcesContent":["/**\n * 搜索结果高亮工具\n */\n\n/**\n * 从搜索查询中提取关键词\n * 移除 FTS5 特殊字符和常见停用词\n *\n * @param query - 搜索查询字符串\n * @returns 关键词数组\n */\nexport function extractKeywords(query: string): string[] {\n  if (!query) return [];\n\n  // 移除 FTS5 运算符和引号\n  const cleaned = query\n    .replace(/[+\\-<>~\"()]/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim();\n\n  // 简单停用词列表（可根据需要扩展）\n  const stopWords = new Set([\n    'the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for',\n    'of', 'with', 'by', 'from', 'as', 'is', 'was', 'are', 'were', 'been',\n    '的', '了', '和', '是', '在', '有', '不', '这', '个', '我', '你', '他',\n  ]);\n\n  // 分词并过滤停用词和空词\n  const keywords = cleaned\n    .split(' ')\n    .map(word => word.toLowerCase().trim())\n    .filter(word => word.length > 1 && !stopWords.has(word));\n\n  return [...new Set(keywords)]; // 去重\n}\n\n/**\n * 高亮文本中的关键词\n * 使用 <mark> 标签包裹匹配的文本\n *\n * @param text - 要高亮的文本\n * @param keywords - 关键词数组\n * @returns 带有高亮标记的 HTML 字符串（需要使用 dangerouslySetInnerHTML）\n */\nexport function highlightKeywords(text: string, keywords: string[]): string {\n  if (!text || !keywords || keywords.length === 0) {\n    return escapeHtml(text);\n  }\n\n  // 转义 HTML 特殊字符\n  let escaped = escapeHtml(text);\n\n  // 按关键词长度降序排序，避免短关键词破坏长关键词的匹配\n  const sortedKeywords = [...keywords].sort((a, b) => b.length - a.length);\n\n  for (const keyword of sortedKeywords) {\n    // 创建正则表达式，全局匹配，忽略大小写\n    const regex = new RegExp(`(${escapeRegex(keyword)})`, 'gi');\n    // 使用 <mark> 标签高亮\n    escaped = escaped.replace(regex, '<mark>$1</mark>');\n  }\n\n  return escaped;\n}\n\n/**\n * 转义 HTML 特殊字符\n */\nfunction escapeHtml(text: string): string {\n  if (!text) return '';\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;');\n}\n\n/**\n * 转义正则表达式特殊字符\n */\nfunction escapeRegex(text: string): string {\n  return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n"],"names":[],"mappings":"AAAA;;CAEC,GAED;;;;;;CAMC;;;;;;AACM,SAAS,gBAAgB,KAAa;IAC3C,IAAI,CAAC,OAAO,OAAO,EAAE;IAErB,iBAAiB;IACjB,MAAM,UAAU,MACb,OAAO,CAAC,gBAAgB,KACxB,OAAO,CAAC,QAAQ,KAChB,IAAI;IAEP,mBAAmB;IACnB,MAAM,YAAY,IAAI,IAAI;QACxB;QAAO;QAAK;QAAM;QAAO;QAAM;QAAO;QAAM;QAAM;QAAM;QAAM;QAC9D;QAAM;QAAQ;QAAM;QAAQ;QAAM;QAAM;QAAO;QAAO;QAAQ;QAC9D;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;QAAK;KACxD;IAED,cAAc;IACd,MAAM,WAAW,QACd,KAAK,CAAC,KACN,GAAG,CAAC,CAAA,OAAQ,KAAK,WAAW,GAAG,IAAI,IACnC,MAAM,CAAC,CAAA,OAAQ,KAAK,MAAM,GAAG,KAAK,CAAC,UAAU,GAAG,CAAC;IAEpD,OAAO;WAAI,IAAI,IAAI;KAAU,EAAE,KAAK;AACtC;AAUO,SAAS,kBAAkB,IAAY,EAAE,QAAkB;IAChE,IAAI,CAAC,QAAQ,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG;QAC/C,OAAO,WAAW;IACpB;IAEA,eAAe;IACf,IAAI,UAAU,WAAW;IAEzB,6BAA6B;IAC7B,MAAM,iBAAiB;WAAI;KAAS,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,MAAM,GAAG,EAAE,MAAM;IAEvE,KAAK,MAAM,WAAW,eAAgB;QACpC,qBAAqB;QACrB,MAAM,QAAQ,IAAI,OAAO,CAAC,CAAC,EAAE,YAAY,SAAS,CAAC,CAAC,EAAE;QACtD,iBAAiB;QACjB,UAAU,QAAQ,OAAO,CAAC,OAAO;IACnC;IAEA,OAAO;AACT;AAEA;;CAEC,GACD,SAAS,WAAW,IAAY;IAC9B,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,KACJ,OAAO,CAAC,MAAM,SACd,OAAO,CAAC,MAAM,QACd,OAAO,CAAC,MAAM,QACd,OAAO,CAAC,MAAM,UACd,OAAO,CAAC,MAAM;AACnB;AAEA;;CAEC,GACD,SAAS,YAAY,IAAY;IAC/B,OAAO,KAAK,OAAO,CAAC,uBAAuB;AAC7C"}},
    {"offset": {"line": 874, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/SnippetCard.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { CodeBlock } from '@/components/ui/CodeBlock';\nimport { SnippetActions } from '@/components/SnippetActions';\nimport { TutorialView } from '@/components/ui/TutorialView';\nimport { type SnippetWithTags, type Tag } from '@/lib/data';\nimport { highlightKeywords, extractKeywords } from '@/lib/highlight';\nimport { useState } from 'react';\n\ninterface SnippetCardProps {\n  snippet: SnippetWithTags;\n  /** 搜索查询字符串，用于高亮匹配的关键词 */\n  query?: string;\n}\n\n/**\n * 代码片段卡片组件\n *\n * 显示单个代码片段的摘要信息，包括：\n * - 标题、描述、语言标签\n * - 代码预览（带语法高亮）\n * - 标签列表\n * - 创建时间\n * - 操作按钮（编辑、删除、教学说明）\n * - 搜索关键词高亮（当提供 query 时）\n *\n * 点击卡片可跳转到详情页\n */\nexport function SnippetCard({ snippet, query }: SnippetCardProps) {\n  const [showTutorial, setShowTutorial] = useState(false);\n\n  // 提取搜索关键词用于高亮\n  const keywords = query ? extractKeywords(query) : [];\n\n  // 生成高亮的 HTML\n  const highlightedTitle = keywords.length > 0\n    ? highlightKeywords(snippet.title, keywords)\n    : snippet.title;\n\n  const highlightedDescription = snippet.description && keywords.length > 0\n    ? highlightKeywords(snippet.description, keywords)\n    : snippet.description;\n  return (\n    <div className=\"break-inside-avoid bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-xl hover:-translate-y-1 hover:border-blue-500/30 transition-all duration-300 ease-in-out overflow-hidden flex flex-col group relative h-fit\">\n      {/* Link overlay - 点击整个卡片跳转 */}\n      <Link\n        href={`/snippets/${snippet.id}`}\n        className=\"absolute inset-0 z-0\"\n        aria-label={`查看 ${snippet.title} 详情`}\n      />\n\n      {/* Card Header */}\n      <div className=\"p-4 border-b border-gray-100 dark:border-gray-700/50 bg-gray-50/50 dark:bg-gray-800/50 relative z-10\">\n        <div className=\"flex justify-between items-start mb-2\">\n          <h2\n            className=\"text-lg font-bold text-gray-900 dark:text-gray-100 line-clamp-1 flex-1 pr-2\"\n            title={snippet.title}\n            dangerouslySetInnerHTML={{ __html: highlightedTitle }}\n          />\n          <div className=\"flex items-center gap-2 shrink-0\">\n            {/* 教学说明按钮 - 只在有教学说明时显示 */}\n            {snippet.tutorial && (\n              <button\n                type=\"button\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setShowTutorial(true);\n                }}\n                className=\"p-1.5 rounded-lg bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors\"\n                title=\"查看教学说明\"\n                aria-label=\"查看教学说明\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\"\n                  />\n                </svg>\n              </button>\n            )}\n            <span className=\"px-2 py-0.5 text-[10px] font-medium uppercase tracking-wider bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-md\">\n              {snippet.language}\n            </span>\n            <SnippetActions snippetId={snippet.id} />\n          </div>\n        </div>\n        {snippet.description && (\n          <p\n            className=\"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-2\"\n            dangerouslySetInnerHTML={{ __html: highlightedDescription || '' }}\n          />\n        )}\n        <div className=\"text-xs text-gray-400 font-mono\">\n          {new Date(snippet.createdAt).toLocaleDateString('zh-CN')}\n        </div>\n      </div>\n\n      {/* Code Block */}\n      <div className=\"p-4 flex-1 relative z-10 pointer-events-none\">\n        <CodeBlock code={snippet.code} language={snippet.language} maxLines={8} />\n      </div>\n\n      {/* Tags */}\n      {snippet.tags.length > 0 && (\n        <div className=\"px-4 pb-4 flex flex-wrap gap-2 relative z-10 pointer-events-none\">\n          {snippet.tags.map(({ tag }: { tag: Tag }) => (\n            <span\n              key={tag.id}\n              className=\"px-2 py-1 text-xs rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300\"\n            >\n              {tag.name}\n            </span>\n          ))}\n        </div>\n      )}\n\n      {/* Tutorial Modal */}\n      {showTutorial && snippet.tutorial && (\n        <TutorialView\n          tutorial={snippet.tutorial}\n          language={snippet.language}\n          onClose={() => setShowTutorial(false)}\n        />\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAEA;AACA;;;AARA;;;;;;;AA6BO,SAAS,YAAY,EAAE,OAAO,EAAE,KAAK,EAAoB;;IAC9D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,cAAc;IACd,MAAM,WAAW,QAAQ,IAAA,oKAAe,EAAC,SAAS,EAAE;IAEpD,aAAa;IACb,MAAM,mBAAmB,SAAS,MAAM,GAAG,IACvC,IAAA,sKAAiB,EAAC,QAAQ,KAAK,EAAE,YACjC,QAAQ,KAAK;IAEjB,MAAM,yBAAyB,QAAQ,WAAW,IAAI,SAAS,MAAM,GAAG,IACpE,IAAA,sKAAiB,EAAC,QAAQ,WAAW,EAAE,YACvC,QAAQ,WAAW;IACvB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC,0KAAI;gBACH,MAAM,CAAC,UAAU,EAAE,QAAQ,EAAE,EAAE;gBAC/B,WAAU;gBACV,cAAY,CAAC,GAAG,EAAE,QAAQ,KAAK,CAAC,GAAG,CAAC;;;;;;0BAItC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,WAAU;gCACV,OAAO,QAAQ,KAAK;gCACpB,yBAAyB;oCAAE,QAAQ;gCAAiB;;;;;;0CAEtD,6LAAC;gCAAI,WAAU;;oCAEZ,QAAQ,QAAQ,kBACf,6LAAC;wCACC,MAAK;wCACL,SAAS,CAAC;4CACR,EAAE,cAAc;4CAChB,EAAE,eAAe;4CACjB,gBAAgB;wCAClB;wCACA,WAAU;wCACV,OAAM;wCACN,cAAW;kDAEX,cAAA,6LAAC;4CAAI,WAAU;4CAAU,MAAK;4CAAO,QAAO;4CAAe,SAAQ;sDACjE,cAAA,6LAAC;gDACC,eAAc;gDACd,gBAAe;gDACf,aAAa;gDACb,GAAE;;;;;;;;;;;;;;;;kDAKV,6LAAC;wCAAK,WAAU;kDACb,QAAQ,QAAQ;;;;;;kDAEnB,6LAAC,gLAAc;wCAAC,WAAW,QAAQ,EAAE;;;;;;;;;;;;;;;;;;oBAGxC,QAAQ,WAAW,kBAClB,6LAAC;wBACC,WAAU;wBACV,yBAAyB;4BAAE,QAAQ,0BAA0B;wBAAG;;;;;;kCAGpE,6LAAC;wBAAI,WAAU;kCACZ,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB,CAAC;;;;;;;;;;;;0BAKpD,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,4KAAS;oBAAC,MAAM,QAAQ,IAAI;oBAAE,UAAU,QAAQ,QAAQ;oBAAE,UAAU;;;;;;;;;;;YAItE,QAAQ,IAAI,CAAC,MAAM,GAAG,mBACrB,6LAAC;gBAAI,WAAU;0BACZ,QAAQ,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,EAAgB,iBACtC,6LAAC;wBAEC,WAAU;kCAET,IAAI,IAAI;uBAHJ,IAAI,EAAE;;;;;;;;;;YAUlB,gBAAgB,QAAQ,QAAQ,kBAC/B,6LAAC,kLAAY;gBACX,UAAU,QAAQ,QAAQ;gBAC1B,UAAU,QAAQ,QAAQ;gBAC1B,SAAS,IAAM,gBAAgB;;;;;;;;;;;;AAKzC;GArGgB;KAAA"}},
    {"offset": {"line": 1078, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/SearchSuggestions.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { MagnifyingGlassIcon, TagIcon, CodeBracketIcon } from '@heroicons/react/24/outline';\nimport { type SuggestionItem } from '@/lib/search-suggestions';\n\ninterface SearchSuggestionsProps {\n  query: string;\n  onQueryChange: (query: string) => void;\n  onSelect: (query: string) => void;\n}\n\n/**\n * 搜索建议下拉组件\n *\n * 功能：\n * - 防抖加载（300ms）\n * - 键盘导航（上下箭头、Enter、ESC）\n * - 分组显示（标题、标签、语言）\n */\nexport function SearchSuggestions({ query, onQueryChange, onSelect }: SearchSuggestionsProps) {\n  const router = useRouter();\n  const [suggestions, setSuggestions] = useState<SuggestionItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const [isOpen, setIsOpen] = useState(false);\n  const debouncedQueryRef = useRef<string>('');\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // 防抖处理搜索查询\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (query !== debouncedQueryRef.current) {\n        debouncedQueryRef.current = query;\n        if (query.length >= 1) {\n          loadSuggestions(query);\n        } else {\n          setSuggestions([]);\n          setIsOpen(false);\n        }\n      }\n    }, 300);\n\n    return () => clearTimeout(timer);\n  }, [query]);\n\n  // 加载搜索建议\n  const loadSuggestions = async (q: string) => {\n    setLoading(true);\n    try {\n      const response = await fetch(`/api/search/suggestions?q=${encodeURIComponent(q)}&limit=5`);\n      const data = await response.json();\n      setSuggestions(data);\n      setIsOpen(data.length > 0);\n      setSelectedIndex(-1);\n    } catch (error) {\n      console.error('Error loading suggestions:', error);\n      setSuggestions([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // 处理键盘导航\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    switch (e.key) {\n      case 'ArrowDown':\n        if (isOpen && suggestions.length > 0) {\n          e.preventDefault();\n          setSelectedIndex(prev => (prev < suggestions.length - 1 ? prev + 1 : 0));\n        }\n        break;\n      case 'ArrowUp':\n        if (isOpen && suggestions.length > 0) {\n          e.preventDefault();\n          setSelectedIndex(prev => (prev > 0 ? prev - 1 : suggestions.length - 1));\n        }\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (isOpen && selectedIndex >= 0 && selectedIndex < suggestions.length) {\n          // 选中建议项\n          handleSelect(suggestions[selectedIndex]);\n        } else {\n          // 执行搜索（包括空搜索，显示全部）\n          onSelect(query.trim());\n          setIsOpen(false);\n          setSelectedIndex(-1);\n        }\n        break;\n      case 'Escape':\n        if (isOpen) {\n          setIsOpen(false);\n          setSelectedIndex(-1);\n          inputRef.current?.blur();\n        }\n        break;\n    }\n  };\n\n  // 选择建议项\n  const handleSelect = (item: SuggestionItem) => {\n    onSelect(item.text);\n    setIsOpen(false);\n    setSelectedIndex(-1);\n  };\n\n  // 点击外部关闭下拉\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // 按类型分组建议\n  const groupedSuggestions = {\n    title: suggestions.filter(s => s.type === 'title'),\n    tag: suggestions.filter(s => s.type === 'tag'),\n    language: suggestions.filter(s => s.type === 'language'),\n  };\n\n  const typeLabels = {\n    title: { label: '标题', icon: MagnifyingGlassIcon },\n    tag: { label: '标签', icon: TagIcon },\n    language: { label: '语言', icon: CodeBracketIcon },\n  };\n\n  return (\n    <div ref={containerRef} className=\"relative\">\n      <input\n        ref={inputRef}\n        type=\"text\"\n        value={query}\n        onChange={e => onQueryChange(e.target.value)}\n        onKeyDown={handleKeyDown}\n        onFocus={() => {\n          if (query.length >= 1 && suggestions.length > 0) {\n            setIsOpen(true);\n          }\n        }}\n        placeholder=\"搜索代码片段...\"\n        className=\"w-full px-4 py-2.5 pl-10 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm\"\n      />\n\n      {/* 搜索图标 */}\n      <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none\" />\n\n      {/* 下拉建议 */}\n      {isOpen && suggestions.length > 0 && (\n        <div className=\"absolute z-50 w-full mt-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl overflow-hidden max-h-80 overflow-y-auto\">\n          {loading && (\n            <div className=\"px-4 py-3 text-sm text-gray-500 dark:text-gray-400 text-center\">\n              加载中...\n            </div>\n          )}\n\n          {!loading && (\n            <>\n              {Object.entries(groupedSuggestions).map(([type, items]) =>\n                items.length > 0 ? (\n                  <div key={type} className=\"border-b border-gray-100 dark:border-gray-700 last:border-b-0\">\n                    <div className=\"px-4 py-2 text-xs font-semibold text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50\">\n                      {typeLabels[type as keyof typeof typeLabels].label}\n                    </div>\n                    {items.map((item, index) => {\n                      const globalIndex = suggestions.indexOf(item);\n                      const isSelected = selectedIndex === globalIndex;\n                      const Icon = typeLabels[item.type].icon;\n\n                      return (\n                        <button\n                          key={`${item.type}-${item.text}`}\n                          onClick={() => handleSelect(item)}\n                          className={`w-full flex items-center gap-3 px-4 py-2.5 text-left hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${\n                            isSelected ? 'bg-blue-50 dark:bg-blue-900/20' : ''\n                          }`}\n                        >\n                          <Icon className=\"w-4 h-4 text-gray-400 shrink-0\" />\n                          <span className=\"flex-1 text-sm text-gray-700 dark:text-gray-300 truncate\">\n                            {item.text}\n                          </span>\n                          {item.count !== undefined && (\n                            <span className=\"text-xs text-gray-400\">\n                              {item.count}\n                            </span>\n                          )}\n                        </button>\n                      );\n                    })}\n                  </div>\n                ) : null\n              )}\n            </>\n          )}\n\n          {/* 快捷键提示 */}\n          <div className=\"px-4 py-2 text-xs text-gray-400 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50\">\n            <span className=\"inline-flex items-center gap-2\">\n              <kbd className=\"px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-[10px]\">↑↓</kbd>\n              导航\n              <kbd className=\"px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-[10px] ml-2\">Enter</kbd>\n              选择\n              <kbd className=\"px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-[10px] ml-2\">ESC</kbd>\n              关闭\n            </span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1389, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/SearchHistory.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { ClockIcon, FireIcon, TrashIcon, XMarkIcon } from '@heroicons/react/24/outline';\n\ninterface HistoryItem {\n  id: string;\n  query: string;\n  filters: string | null;\n  resultCount: number;\n  createdAt: string;\n}\n\ninterface StatsItem {\n  id: string;\n  query: string;\n  searchCount: number;\n  lastSearchedAt: string;\n}\n\n/**\n * 搜索历史组件\n *\n * 显示：\n * - 搜索历史记录\n * - 热门搜索（从 SearchStats 获取）\n */\nexport function SearchHistory() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [isOpen, setIsOpen] = useState(false);\n  const [activeTab, setActiveTab] = useState<'history' | 'popular'>('history');\n  const [history, setHistory] = useState<HistoryItem[]>([]);\n  const [popular, setPopular] = useState<StatsItem[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  // 加载数据\n  useEffect(() => {\n    if (isOpen) {\n      loadData();\n    }\n  }, [isOpen, activeTab]);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      if (activeTab === 'history') {\n        const response = await fetch('/api/search/history?limit=10');\n        const data = await response.json();\n        // 确保 data 是数组\n        setHistory(Array.isArray(data) ? data : []);\n      } else {\n        const response = await fetch('/api/search/stats?limit=10');\n        const data = await response.json();\n        // 确保 data 是数组\n        setPopular(Array.isArray(data) ? data : []);\n      }\n    } catch (error) {\n      console.error('Error loading search data:', error);\n      // 出错时设置为空数组\n      if (activeTab === 'history') {\n        setHistory([]);\n      } else {\n        setPopular([]);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // 快速重新搜索\n  const quickSearch = (query: string) => {\n    const params = new URLSearchParams();\n    params.set('q', query);\n    router.push(`/?${params.toString()}`);\n    setIsOpen(false);\n  };\n\n  // 删除单条历史\n  const deleteHistoryItem = async (id: string) => {\n    try {\n      await fetch(`/api/search/history?id=${id}`, { method: 'DELETE' });\n      setHistory(prev => prev.filter(item => item.id !== id));\n    } catch (error) {\n      console.error('Error deleting history item:', error);\n    }\n  };\n\n  // 清空所有历史\n  const clearAllHistory = async () => {\n    try {\n      await fetch('/api/search/history', { method: 'DELETE' });\n      setHistory([]);\n    } catch (error) {\n      console.error('Error clearing history:', error);\n    }\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* 切换按钮 */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"p-2.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors\"\n        title=\"搜索历史\"\n      >\n        <ClockIcon className=\"w-5 h-5\" />\n      </button>\n\n      {/* 下拉面板 */}\n      {isOpen && (\n        <>\n          {/* 遮罩层 */}\n          <div\n            className=\"fixed inset-0 z-10\"\n            onClick={() => setIsOpen(false)}\n          />\n\n          {/* 面板内容 */}\n          <div className=\"absolute right-0 top-12 z-20 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl overflow-hidden\">\n            {/* 头部 */}\n            <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={() => setActiveTab('history')}\n                  className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${\n                    activeTab === 'history'\n                      ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300'\n                      : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                  }`}\n                >\n                  历史记录\n                </button>\n                <button\n                  onClick={() => setActiveTab('popular')}\n                  className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${\n                    activeTab === 'popular'\n                      ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300'\n                      : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                  }`}\n                >\n                  热门搜索\n                </button>\n              </div>\n              <button\n                onClick={() => setIsOpen(false)}\n                className=\"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"w-5 h-5\" />\n              </button>\n            </div>\n\n            {/* 内容区域 */}\n            <div className=\"max-h-96 overflow-y-auto p-2\">\n              {loading ? (\n                <div className=\"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400\">\n                  加载中...\n                </div>\n              ) : (\n                <>\n                  {activeTab === 'history' ? (\n                    <>\n                      {history.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400 text-sm\">\n                          暂无搜索历史\n                        </div>\n                      ) : (\n                        <>\n                          <div className=\"flex items-center justify-between mb-2 px-2\">\n                            <span className=\"text-xs text-gray-500 dark:text-gray-400\">最近搜索</span>\n                            {history.length > 0 && (\n                              <button\n                                onClick={clearAllHistory}\n                                className=\"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 flex items-center gap-1\"\n                              >\n                                <TrashIcon className=\"w-3 h-3\" />\n                                清空\n                              </button>\n                            )}\n                          </div>\n                          <div className=\"space-y-1\">\n                            {history.map(item => (\n                              <div\n                                key={item.id}\n                                className=\"group flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n                              >\n                                <ClockIcon className=\"w-4 h-4 text-gray-400 shrink-0\" />\n                                <button\n                                  onClick={() => quickSearch(item.query)}\n                                  className=\"flex-1 text-left text-sm text-gray-700 dark:text-gray-300 truncate\"\n                                >\n                                  {item.query}\n                                </button>\n                                <button\n                                  onClick={() => deleteHistoryItem(item.id)}\n                                  className=\"opacity-0 group-hover:opacity-100 p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-all\"\n                                >\n                                  <XMarkIcon className=\"w-4 h-4\" />\n                                </button>\n                              </div>\n                            ))}\n                          </div>\n                        </>\n                      )}\n                    </>\n                  ) : (\n                    <>\n                      {popular.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400 text-sm\">\n                          暂无热门搜索\n                        </div>\n                      ) : (\n                        <>\n                          <div className=\"mb-2 px-2\">\n                            <span className=\"text-xs text-gray-500 dark:text-gray-400\">热门搜索</span>\n                          </div>\n                          <div className=\"space-y-1\">\n                            {popular.map((item, index) => (\n                              <button\n                                key={item.id}\n                                onClick={() => quickSearch(item.query)}\n                                className=\"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors text-left\"\n                              >\n                                <span className={`text-sm font-bold w-5 ${\n                                  index < 3 ? 'text-orange-500' : 'text-gray-400'\n                                }`}>\n                                  {index + 1}\n                                </span>\n                                <FireIcon className=\"w-4 h-4 text-orange-500 shrink-0\" />\n                                <span className=\"flex-1 text-sm text-gray-700 dark:text-gray-300 truncate\">\n                                  {item.query}\n                                </span>\n                                <span className=\"text-xs text-gray-400\">\n                                  {item.searchCount} 次\n                                </span>\n                              </button>\n                            ))}\n                          </div>\n                        </>\n                      )}\n                    </>\n                  )}\n                </>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1784, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/ui/SearchBar.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useSearchParams, usePathname, useRouter } from 'next/navigation';\nimport { useDebouncedCallback } from 'use-debounce';\nimport { SearchSuggestions } from '@/components/SearchSuggestions';\nimport { SearchHistory } from '@/components/SearchHistory';\n\nexport function SearchBar() {\n  const searchParams = useSearchParams();\n  const pathname = usePathname();\n  const router = useRouter();\n  const [query, setQuery] = useState(searchParams.get('q') || '');\n\n  // 更新本地状态当 URL 参数变化时\n  useEffect(() => {\n    setQuery(searchParams.get('q') || '');\n  }, [searchParams]);\n\n  const handleSearch = useDebouncedCallback((term: string) => {\n    const params = new URLSearchParams(searchParams);\n\n    if (term) {\n      params.set('q', term);\n    } else {\n      params.delete('q');\n    }\n\n    router.replace(`${pathname}?${params.toString()}`);\n  }, 300);\n\n  const handleSelect = (term: string) => {\n    setQuery(term);\n    const params = new URLSearchParams(searchParams);\n    params.set('q', term);\n    router.replace(`${pathname}?${params.toString()}`);\n  };\n\n  return (\n    <div className=\"flex items-center gap-2 w-full max-w-md\">\n      <div className=\"relative flex-1\">\n        <SearchSuggestions\n          query={query}\n          onQueryChange={setQuery}\n          onSelect={handleSelect}\n        />\n      </div>\n      <SearchHistory />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAQO,SAAS;;IACd,MAAM,eAAe,IAAA,wJAAe;IACpC,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC,aAAa,GAAG,CAAC,QAAQ;IAE5D,oBAAoB;IACpB,IAAA,0KAAS;+BAAC;YACR,SAAS,aAAa,GAAG,CAAC,QAAQ;QACpC;8BAAG;QAAC;KAAa;IAEjB,MAAM,eAAe,IAAA,qLAAoB;wDAAC,CAAC;YACzC,MAAM,SAAS,IAAI,gBAAgB;YAEnC,IAAI,MAAM;gBACR,OAAO,GAAG,CAAC,KAAK;YAClB,OAAO;gBACL,OAAO,MAAM,CAAC;YAChB;YAEA,OAAO,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,OAAO,QAAQ,IAAI;QACnD;uDAAG;IAEH,MAAM,eAAe,CAAC;QACpB,SAAS;QACT,MAAM,SAAS,IAAI,gBAAgB;QACnC,OAAO,GAAG,CAAC,KAAK;QAChB,OAAO,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE,OAAO,QAAQ,IAAI;IACnD;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,sLAAiB;oBAChB,OAAO;oBACP,eAAe;oBACf,UAAU;;;;;;;;;;;0BAGd,6LAAC,8KAAa;;;;;;;;;;;AAGpB;GA1CgB;;QACO,wJAAe;QACnB,oJAAW;QACb,kJAAS;QAQH,qLAAoB;;;KAX3B"}},
    {"offset": {"line": 1882, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/AdvancedSearchPanel.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { ChevronDownIcon, ChevronUpIcon } from '@heroicons/react/24/outline';\nimport { Icon } from '@iconify/react';\n\ninterface Metadata {\n  languages: string[];\n  tags: Array<{ id: string; name: string; color?: string | null }>;\n}\n\ninterface AdvancedSearchPanelProps {\n  metadata: Metadata;\n}\n\n/**\n * 高级搜索面板组件\n *\n * 可折叠的筛选面板，提供以下功能：\n * - 语言多选器\n * - 标签多选器\n * - 时间范围选择器\n * - 排序选择器\n */\nexport function AdvancedSearchPanel({ metadata }: AdvancedSearchPanelProps) {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [isOpen, setIsOpen] = useState(false);\n\n  // 当前选中的筛选条件\n  const [selectedLanguages, setSelectedLanguages] = useState<string[]>([]);\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n  const [dateRange, setDateRange] = useState<string>('all');\n  const [sortBy, setSortBy] = useState<string>('createdAt');\n  const [sortOrder, setSortOrder] = useState<string>('desc');\n\n  // 从 URL 初始化筛选条件\n  useEffect(() => {\n    const languages = searchParams.get('languages')?.split(',').filter(Boolean) || [];\n    const tags = searchParams.get('tags')?.split(',').filter(Boolean) || [];\n    const range = searchParams.get('dateRange') || 'all';\n    const sort = searchParams.get('sortBy') || 'createdAt';\n    const order = searchParams.get('sortOrder') || 'desc';\n\n    setSelectedLanguages(languages);\n    setSelectedTags(tags);\n    setDateRange(range);\n    setSortBy(sort);\n    setSortOrder(order);\n  }, [searchParams]);\n\n  // 应用筛选\n  const applyFilters = () => {\n    const params = new URLSearchParams();\n\n    // 保留搜索查询\n    const q = searchParams.get('q');\n    if (q) params.set('q', q);\n\n    // 设置筛选条件\n    if (selectedLanguages.length > 0) {\n      params.set('languages', selectedLanguages.join(','));\n    }\n    if (selectedTags.length > 0) {\n      params.set('tags', selectedTags.join(','));\n    }\n    if (dateRange !== 'all') {\n      params.set('dateRange', dateRange);\n    }\n    if (sortBy !== 'createdAt') {\n      params.set('sortBy', sortBy);\n    }\n    if (sortOrder !== 'desc') {\n      params.set('sortOrder', sortOrder);\n    }\n\n    router.push(`/?${params.toString()}`);\n    setIsOpen(false);\n  };\n\n  // 切换语言选择\n  const toggleLanguage = (lang: string) => {\n    setSelectedLanguages(prev =>\n      prev.includes(lang) ? prev.filter(l => l !== lang) : [...prev, lang]\n    );\n  };\n\n  // 切换标签选择\n  const toggleTag = (tag: string) => {\n    setSelectedTags(prev =>\n      prev.includes(tag) ? prev.filter(t => t !== tag) : [...prev, tag]\n    );\n  };\n\n  return (\n    <div className=\"mb-6\">\n      {/* 切换按钮 */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center gap-2 px-4 py-2.5 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl font-medium shadow-sm hover:shadow-md transition-all duration-200 text-gray-700 dark:text-gray-300\"\n      >\n        <Icon icon=\"lucide:sliders-horizontal\" className=\"w-5 h-5\" />\n        <span>高级筛选</span>\n        {isOpen ? (\n          <ChevronUpIcon className=\"w-5 h-5\" />\n        ) : (\n          <ChevronDownIcon className=\"w-5 h-5\" />\n        )}\n      </button>\n\n      {/* 面板内容 */}\n      {isOpen && (\n        <div className=\"mt-4 p-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-sm space-y-6\">\n          {/* 语言筛选 */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\n              <Icon icon=\"lucide:code-2\" className=\"w-4 h-4\" />\n              编程语言\n            </h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {metadata.languages.map(lang => (\n                <button\n                  key={lang}\n                  onClick={() => toggleLanguage(lang)}\n                  className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                    selectedLanguages.includes(lang)\n                      ? 'bg-blue-600 text-white'\n                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                  }`}\n                >\n                  {lang}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* 标签筛选 */}\n          {metadata.tags.length > 0 && (\n            <div>\n              <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\n                <Icon icon=\"lucide:tag\" className=\"w-4 h-4\" />\n                标签\n              </h3>\n              <div className=\"flex flex-wrap gap-2\">\n                {metadata.tags.map(tag => (\n                  <button\n                    key={tag.id}\n                    onClick={() => toggleTag(tag.name)}\n                    className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                      selectedTags.includes(tag.name)\n                        ? 'bg-green-600 text-white'\n                        : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                    }`}\n                  >\n                    {tag.name}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* 时间范围筛选 */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\n              <Icon icon=\"lucide:calendar\" className=\"w-4 h-4\" />\n              时间范围\n            </h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {[\n                { value: 'all', label: '全部' },\n                { value: 'today', label: '今天' },\n                { value: 'week', label: '最近一周' },\n                { value: 'month', label: '最近一月' },\n                { value: 'quarter', label: '最近三月' },\n              ].map(option => (\n                <button\n                  key={option.value}\n                  onClick={() => setDateRange(option.value)}\n                  className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                    dateRange === option.value\n                      ? 'bg-purple-600 text-white'\n                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                  }`}\n                >\n                  {option.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* 排序选项 */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\n              <Icon icon=\"lucide:arrow-up-down\" className=\"w-4 h-4\" />\n              排序方式\n            </h3>\n            <div className=\"flex flex-wrap gap-4\">\n              <select\n                value={sortBy}\n                onChange={e => setSortBy(e.target.value)}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"createdAt\">创建时间</option>\n                <option value=\"updatedAt\">更新时间</option>\n              </select>\n\n              <select\n                value={sortOrder}\n                onChange={e => setSortOrder(e.target.value)}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"desc\">降序</option>\n                <option value=\"asc\">升序</option>\n              </select>\n            </div>\n          </div>\n\n          {/* 操作按钮 */}\n          <div className=\"flex items-center gap-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n            <button\n              onClick={applyFilters}\n              className=\"inline-flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium shadow-md hover:shadow-lg transition-all duration-200\"\n            >\n              <Icon icon=\"lucide:check\" className=\"w-4 h-4\" />\n              应用筛选\n            </button>\n            <button\n              onClick={() => {\n                setSelectedLanguages([]);\n                setSelectedTags([]);\n                setDateRange('all');\n                setSortBy('createdAt');\n                setSortOrder('desc');\n              }}\n              className=\"inline-flex items-center gap-2 px-6 py-2.5 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-medium transition-colors\"\n            >\n              <Icon icon=\"lucide:rotate-ccw\" className=\"w-4 h-4\" />\n              重置\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2328, "column": 0}, "map": {"version":3,"sources":["file:///mnt/Files/Ts-space/apps/snippet-manager/components/FilterChips.tsx"],"sourcesContent":["'use client';\n\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { Icon } from '@iconify/react';\n\ninterface FilterChipsProps {\n  languages?: string[];\n  tags?: string[];\n  dateRange?: string;\n  sortBy?: string;\n  sortOrder?: string;\n}\n\n/**\n * 筛选条件标签组件\n *\n * 显示当前激活的筛选条件，允许用户快速移除单个筛选或清除所有筛选\n */\nexport function FilterChips({\n  languages,\n  tags,\n  dateRange,\n  sortBy,\n  sortOrder,\n}: FilterChipsProps) {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n\n  // 移除单个筛选条件\n  const removeFilter = (key: string, value?: string) => {\n    const params = new URLSearchParams(searchParams.toString());\n\n    if (value) {\n      // 对于数组类型的筛选（语言、标签），移除特定值\n      const currentValues = params.get(key)?.split(',').filter(v => v !== value) || [];\n      if (currentValues.length > 0) {\n        params.set(key, currentValues.join(','));\n      } else {\n        params.delete(key);\n      }\n    } else {\n      // 对于单个值的筛选，直接删除\n      params.delete(key);\n    }\n\n    router.push(`/?${params.toString()}`);\n  };\n\n  // 清除所有筛选\n  const clearAllFilters = () => {\n    const params = new URLSearchParams();\n    const q = searchParams.get('q');\n    if (q) params.set('q', q);\n    router.push(`/?${params.toString()}`);\n  };\n\n  // 检查是否有激活的筛选\n  const hasFilters =\n    (languages && languages.length > 0) ||\n    (tags && tags.length > 0) ||\n    dateRange ||\n    sortBy ||\n    sortOrder;\n\n  if (!hasFilters) return null;\n\n  // 日期范围显示名称\n  const dateRangeLabels: Record<string, string> = {\n    today: '今天',\n    week: '最近一周',\n    month: '最近一月',\n    quarter: '最近三月',\n    all: '全部',\n  };\n\n  // 排序显示名称\n  const sortByLabels: Record<string, string> = {\n    createdAt: '创建时间',\n    updatedAt: '更新时间',\n  };\n\n  const sortOrderLabels: Record<string, string> = {\n    asc: '升序',\n    desc: '降序',\n  };\n\n  return (\n    <div className=\"mb-6 flex flex-wrap items-center gap-2\">\n      <span className=\"text-sm text-gray-500 dark:text-gray-400\">筛选条件：</span>\n\n      {/* 语言筛选 */}\n      {languages?.map(lang => (\n        <button\n          key={lang}\n          onClick={() => removeFilter('languages', lang)}\n          className=\"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-sm font-medium hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors\"\n        >\n          <Icon icon=\"lucide:code-2\" className=\"w-3.5 h-3.5\" />\n          <span>{lang}</span>\n          <XMarkIcon className=\"w-3.5 h-3.5 ml-0.5\" />\n        </button>\n      ))}\n\n      {/* 标签筛选 */}\n      {tags?.map(tag => (\n        <button\n          key={tag}\n          onClick={() => removeFilter('tags', tag)}\n          className=\"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full text-sm font-medium hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors\"\n        >\n          <Icon icon=\"lucide:tag\" className=\"w-3.5 h-3.5\" />\n          <span>{tag}</span>\n          <XMarkIcon className=\"w-3.5 h-3.5 ml-0.5\" />\n        </button>\n      ))}\n\n      {/* 时间范围筛选 */}\n      {dateRange && (\n        <button\n          onClick={() => removeFilter('dateRange')}\n          className=\"inline-flex items-center gap-1.5 px-3 py-1.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full text-sm font-medium hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors\"\n        >\n          <Icon icon=\"lucide:calendar\" className=\"w-3.5 h-3.5\" />\n          <span>{dateRangeLabels[dateRange]}</span>\n          <XMarkIcon className=\"w-3.5 h-3.5 ml-0.5\" />\n        </button>\n      )}\n\n      {/* 排序筛选 */}\n      {(sortBy || sortOrder) && (\n        <button\n          onClick={() => {\n            if (sortBy) removeFilter('sortBy');\n            if (sortOrder) removeFilter('sortOrder');\n          }}\n          className=\"inline-flex items-center gap-1.5 px-3 py-1.5 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded-full text-sm font-medium hover:bg-orange-200 dark:hover:bg-orange-900/50 transition-colors\"\n        >\n          <Icon icon=\"lucide:arrow-up-down\" className=\"w-3.5 h-3.5\" />\n          <span>\n            {sortBy && sortByLabels[sortBy]}\n            {sortOrder && ` · ${sortOrderLabels[sortOrder]}`}\n          </span>\n          <XMarkIcon className=\"w-3.5 h-3.5 ml-0.5\" />\n        </button>\n      )}\n\n      {/* 清除所有按钮 */}\n      <button\n        onClick={clearAllFilters}\n        className=\"inline-flex items-center gap-1.5 px-3 py-1.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors ml-2\"\n      >\n        <Icon icon=\"lucide:trash-2\" className=\"w-3.5 h-3.5\" />\n        <span>清除全部</span>\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}